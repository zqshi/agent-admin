# æŒ‡æ ‡ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

æœ¬ç³»ç»Ÿä¸ºæ•°å­—å‘˜å·¥ç®¡ç†å¹³å°æä¾›äº†å®Œæ•´çš„æŒ‡æ ‡æ ‡å‡†åŒ–è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æŒ‡æ ‡å®šä¹‰ã€éªŒè¯ã€ç®¡ç†å’Œä¸€è‡´æ€§æ£€æŸ¥ç­‰åŠŸèƒ½ã€‚

## ğŸ¯ ä¸»è¦åŠŸèƒ½

### âœ… å·²å®ç°åŠŸèƒ½
- **æ ‡å‡†åŒ–æŒ‡æ ‡å®šä¹‰**: ç»Ÿä¸€çš„æŒ‡æ ‡æ¨¡æ¿å’Œç±»å‹ç³»ç»Ÿ
- **æŒ‡æ ‡éªŒè¯å™¨**: è‡ªåŠ¨æ£€æŸ¥æŒ‡æ ‡å®šä¹‰çš„è§„èŒƒæ€§
- **æŒ‡æ ‡æ³¨å†Œè¡¨**: é›†ä¸­ç®¡ç†æ‰€æœ‰æ ‡å‡†æŒ‡æ ‡å®šä¹‰
- **ä¸€è‡´æ€§æ£€æŸ¥**: æ‰«æä»£ç åº“å‘ç°æŒ‡æ ‡ä½¿ç”¨ä¸ä¸€è‡´çš„é—®é¢˜
- **è‡ªåŠ¨ä¿®å¤**: æ‰¹é‡ä¿®å¤å¯è‡ªåŠ¨å¤„ç†çš„ä¸€è‡´æ€§é—®é¢˜
- **å‘½ä»¤è¡Œå·¥å…·**: ä¾¿äºé›†æˆåˆ°CI/CDæµç¨‹ä¸­
- **å®Œæ•´æ–‡æ¡£**: è¯¦ç»†çš„ä½¿ç”¨æŒ‡å—å’ŒAPIæ–‡æ¡£

## ğŸ“ æ–‡ä»¶ç»“æ„

```
project/
â”œâ”€â”€ docs/03-æŠ€æœ¯æ–‡æ¡£/
â”‚   â”œâ”€â”€ æŒ‡æ ‡æ ‡å‡†æ¨¡æ¿è§„èŒƒ.md          # å®Œæ•´çš„æ ‡å‡†è§„èŒƒæ–‡æ¡£
â”‚   â””â”€â”€ æŒ‡æ ‡ç³»ç»Ÿä½¿ç”¨æŒ‡å—.md          # æœ¬æ–‡ä»¶
â”œâ”€â”€ src/types/
â”‚   â””â”€â”€ metric-types.ts              # æ ‡å‡†æŒ‡æ ‡ç±»å‹å®šä¹‰
â”œâ”€â”€ src/utils/
â”‚   â”œâ”€â”€ metric-validator.ts          # æŒ‡æ ‡éªŒè¯å·¥å…·
â”‚   â”œâ”€â”€ metric-consistency-checker.ts # ä¸€è‡´æ€§æ£€æŸ¥å™¨
â”‚   â””â”€â”€ metric-registry.ts           # æŒ‡æ ‡æ³¨å†Œè¡¨
â”œâ”€â”€ src/scripts/
â”‚   â””â”€â”€ metric-consistency-cli.ts    # å‘½ä»¤è¡Œå·¥å…·
â””â”€â”€ src/examples/
    â””â”€â”€ metric-usage-example.ts      # ä½¿ç”¨ç¤ºä¾‹
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

ç¡®ä¿é¡¹ç›®å·²å®‰è£…å¿…è¦çš„ä¾èµ–ï¼š

```bash
npm install typescript @types/node tsx
```

### 2. è¿è¡Œä¸€è‡´æ€§æ£€æŸ¥

```bash
# åŸºæœ¬æ£€æŸ¥
npm run check-metrics

# æ£€æŸ¥å¹¶è‡ªåŠ¨ä¿®å¤é—®é¢˜
npm run check-metrics:fix

# ç”Ÿæˆè¯¦ç»†çš„MarkdownæŠ¥å‘Š
npm run check-metrics:report
```

### 3. è¿è¡Œä½¿ç”¨ç¤ºä¾‹

```bash
npx tsx src/examples/metric-usage-example.ts
```

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### åˆ›å»ºæ–°æŒ‡æ ‡å®šä¹‰

```typescript
import { MetricDefinitionBuilder, MetricCategory, MetricLevel, MetricUnit } from '../types/metric-types';

const newMetric = new MetricDefinitionBuilder()
  .id('performance_api_responseTime')
  .name('apiResponseTime')
  .displayName('APIå“åº”æ—¶é—´')
  .category(MetricCategory.PERFORMANCE)
  .level(MetricLevel.L3)
  .domains('api_performance')
  .description('APIæ¥å£çš„å¹³å‡å“åº”æ—¶é—´')
  .formula('æ‰€æœ‰APIè¯·æ±‚å“åº”æ—¶é—´æ€»å’Œ / æ€»è¯·æ±‚æ•°')
  .unit(MetricUnit.MILLISECONDS)
  .dataType(MetricDataType.INTEGER)
  .precision(0)
  .range(0, 30000)
  .qualityThresholds({
    excellent: 2000,
    good: 3000,
    warning: 5000,
    critical: 10000
  })
  .format({
    displayType: 'duration',
    thousandsSeparator: false,
    suffix: 'ms'
  })
  .governance({
    owner: 'æŠ€æœ¯å›¢é˜Ÿ',
    reviewCycle: 'quarterly',
    lastReviewed: new Date().toISOString(),
    approvalStatus: MetricStatus.APPROVED
  })
  .version('1.0.0')
  .tags('performance', 'api', 'technical')
  .build();
```

### éªŒè¯æŒ‡æ ‡å®šä¹‰

```typescript
import { MetricValidator } from '../utils/metric-validator';

const validationResult = MetricValidator.validate(newMetric);

if (!validationResult.isValid) {
  console.log('éªŒè¯å¤±è´¥:', validationResult.errors);
}
```

### ä½¿ç”¨æŒ‡æ ‡æ³¨å†Œè¡¨

```typescript
import { metricRegistry } from '../utils/metric-registry';

// æ³¨å†ŒæŒ‡æ ‡
metricRegistry.registerMetric(newMetric);

// æœç´¢æŒ‡æ ‡
const results = metricRegistry.searchMetrics({
  query: 'å“åº”æ—¶é—´',
  category: MetricCategory.PERFORMANCE
});

// è·å–æŒ‡æ ‡
const metric = metricRegistry.getMetric('performance_api_responseTime');
```

## ğŸ“Š æŒ‡æ ‡åˆ†å±‚ä½“ç³»

### L1 æ ¸å¿ƒä¸šåŠ¡æŒ‡æ ‡
- **ç”¨é€”**: ç›´æ¥åæ˜ ä¸šåŠ¡ä»·å€¼å’Œç”¨æˆ·ä½“éªŒ
- **è´£ä»»äºº**: äº§å“å›¢é˜Ÿ
- **å®¡æŸ¥å‘¨æœŸ**: æ¯æœˆ
- **ç¤ºä¾‹**: taskSuccessRate, userValueDensity

### L2 æ”¯æ’‘åˆ†ææŒ‡æ ‡
- **ç”¨é€”**: æ”¯æ’‘L1æŒ‡æ ‡åˆ†æå’Œè¯Šæ–­
- **è´£ä»»äºº**: è´¨é‡å›¢é˜Ÿ
- **å®¡æŸ¥å‘¨æœŸ**: æ¯å­£åº¦
- **ç¤ºä¾‹**: effectiveInteractionDepth, firstResponseHitRate

### L3 æŠ€æœ¯ç›‘æ§æŒ‡æ ‡
- **ç”¨é€”**: æŠ€æœ¯å±‚é¢çš„ç›‘æ§å’Œè¿ç»´
- **è´£ä»»äºº**: æŠ€æœ¯å›¢é˜Ÿ
- **å®¡æŸ¥å‘¨æœŸ**: æ¯å­£åº¦
- **ç¤ºä¾‹**: avgResponseTime, sessionSuccessRate

## ğŸ¨ å‘½åè§„èŒƒ

### é€šç”¨è§„åˆ™
- ä½¿ç”¨é©¼å³°å‘½åæ³• (camelCase)
- é¿å…ç¼©å†™ï¼Œä½¿ç”¨å®Œæ•´å•è¯
- åç§°è¦æ¸…æ™°ã€å‡†ç¡®ã€æ— æ­§ä¹‰

### ç‰¹å®šåç¼€
- **æ—¶é—´æŒ‡æ ‡**: `Time`, `Duration`, `Latency`
- **æ¯”ç‡æŒ‡æ ‡**: `Rate`, `Ratio`, `Percentage` 
- **æ•°é‡æŒ‡æ ‡**: `total*`, `*Count`, `avg*`

### ç¦ç”¨å‘½å
âŒ `respTime`, `succRate`, `response_time`  
âœ… `responseTime`, `successRate`

## ğŸ” ä¸€è‡´æ€§æ£€æŸ¥

### æ£€æŸ¥é¡¹ç›®
- âœ… å‘½åè§„èŒƒä¸€è‡´æ€§
- âœ… å•ä½æ ¼å¼ç»Ÿä¸€æ€§
- âœ… æ•°å€¼èŒƒå›´ä¸€è‡´æ€§
- âœ… æ¥å£å®šä¹‰é‡å¤æ€§
- âœ… æ ‡å‡†æŒ‡æ ‡è¦†ç›–åº¦

### è‡ªåŠ¨ä¿®å¤åŠŸèƒ½
- âœ… æ‰¹é‡é‡å‘½åä¸è§„èŒƒçš„å­—æ®µ
- âœ… ç»Ÿä¸€æ•°å€¼èŒƒå›´æ ¼å¼
- âœ… ä¿®å¤ç®€å•çš„æ ¼å¼ä¸ä¸€è‡´

### æ£€æŸ¥æŠ¥å‘Š
ç”Ÿæˆçš„æŠ¥å‘ŠåŒ…å«ï¼š
- é—®é¢˜ç»Ÿè®¡å’Œåˆ†ç±»
- è¯¦ç»†çš„é—®é¢˜åˆ—è¡¨
- ä¿®å¤å»ºè®®å’Œä¼˜å…ˆçº§
- å¯è‡ªåŠ¨ä¿®å¤çš„é¡¹ç›®æ ‡è¯†

## ğŸ› ï¸ å‘½ä»¤è¡Œå·¥å…·

### åŸºæœ¬ç”¨æ³•

```bash
# æ˜¾ç¤ºå¸®åŠ©
npx tsx src/scripts/metric-consistency-cli.ts --help

# æ‰§è¡ŒåŸºæœ¬æ£€æŸ¥
npx tsx src/scripts/metric-consistency-cli.ts --check

# è‡ªåŠ¨ä¿®å¤é—®é¢˜
npx tsx src/scripts/metric-consistency-cli.ts --fix

# ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
npx tsx src/scripts/metric-consistency-cli.ts --report --format markdown -o report.md

# è¯¦ç»†è¾“å‡º
npx tsx src/scripts/metric-consistency-cli.ts --verbose
```

### é…ç½®Package.json

åœ¨ `package.json` ä¸­æ·»åŠ ä¾¿æ·è„šæœ¬ï¼š

```json
{
  "scripts": {
    "check-metrics": "npx tsx src/scripts/metric-consistency-cli.ts",
    "check-metrics:fix": "npx tsx src/scripts/metric-consistency-cli.ts --fix",
    "check-metrics:report": "npx tsx src/scripts/metric-consistency-cli.ts --report --format markdown -o docs/metric-consistency-report.md"
  }
}
```

## ğŸ”„ CI/CD é›†æˆ

### GitHub Actions ç¤ºä¾‹

```yaml
name: æŒ‡æ ‡ä¸€è‡´æ€§æ£€æŸ¥
on: [push, pull_request]

jobs:
  metric-consistency:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v2
      with:
        node-version: '16'
    
    - run: npm install
    - run: npm run check-metrics
      name: æ£€æŸ¥æŒ‡æ ‡ä¸€è‡´æ€§
    
    - run: npm run check-metrics:report
      name: ç”Ÿæˆä¸€è‡´æ€§æŠ¥å‘Š
      if: always()
    
    - uses: actions/upload-artifact@v2
      with:
        name: metric-consistency-report
        path: docs/metric-consistency-report.md
      if: always()
```

## ğŸ“ˆ æœ€ä½³å®è·µ

### 1. æŒ‡æ ‡è®¾è®¡åŸåˆ™
- **SMARTåŸåˆ™**: Specific, Measurable, Achievable, Relevant, Time-bound
- **æœ€å°æƒŠè®¶åŸåˆ™**: æŒ‡æ ‡è¡Œä¸ºç¬¦åˆç›´è§‰é¢„æœŸ
- **å‘åå…¼å®¹**: é¿å…ç ´åæ€§å˜æ›´

### 2. è´¨é‡ä¿è¯
- å®šæœŸå®¡æŸ¥æŒ‡æ ‡å®šä¹‰å’Œé˜ˆå€¼
- éªŒè¯æŒ‡æ ‡è®¡ç®—çš„å‡†ç¡®æ€§
- ç›‘æ§æŒ‡æ ‡æ•°æ®è´¨é‡

### 3. å›¢é˜Ÿåä½œ
- æ˜ç¡®æŒ‡æ ‡è´Ÿè´£äººå’Œå®¡æŸ¥æµç¨‹
- æ–‡æ¡£åŒ–æŒ‡æ ‡å˜æ›´çš„å½±å“è¯„ä¼°
- å»ºç«‹æŒ‡æ ‡ä½¿ç”¨åŸ¹è®­æœºåˆ¶

### 4. æ€§èƒ½ä¼˜åŒ–
- æ‰¹é‡è®¡ç®—ç›¸å…³æŒ‡æ ‡
- åˆç†è®¾ç½®æŒ‡æ ‡è®¡ç®—é¢‘ç‡
- ä½¿ç”¨ç¼“å­˜å‡å°‘é‡å¤è®¡ç®—

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: æŒ‡æ ‡éªŒè¯å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**  
A: æŸ¥çœ‹éªŒè¯é”™è¯¯ä¿¡æ¯ï¼ŒæŒ‰ç…§æç¤ºä¿®æ”¹æŒ‡æ ‡å®šä¹‰ã€‚å¸¸è§é—®é¢˜åŒ…æ‹¬ç¼ºå°‘å¿…å¡«å­—æ®µã€å‘½åä¸è§„èŒƒç­‰ã€‚

**Q: ä¸€è‡´æ€§æ£€æŸ¥æŠ¥å‘Šä¸­çš„é—®é¢˜å¦‚ä½•ä¿®å¤ï¼Ÿ**  
A: ä¼˜å…ˆå¤„ç† critical å’Œ high çº§åˆ«çš„é—®é¢˜ã€‚å¯ä»¥ä½¿ç”¨ `--fix` å‚æ•°è‡ªåŠ¨ä¿®å¤éƒ¨åˆ†é—®é¢˜ã€‚

**Q: å¦‚ä½•æ·»åŠ æ–°çš„æŒ‡æ ‡ç±»åˆ«ï¼Ÿ**  
A: åœ¨ `MetricCategory` æšä¸¾ä¸­æ·»åŠ æ–°ç±»åˆ«ï¼Œå¹¶æ›´æ–°ç›¸å…³çš„æ¨¡æ¿å’ŒéªŒè¯è§„åˆ™ã€‚

**Q: æŒ‡æ ‡è®¡ç®—æ€§èƒ½é—®é¢˜æ€ä¹ˆè§£å†³ï¼Ÿ**  
A: è€ƒè™‘æ‰¹é‡è®¡ç®—ã€å¢åŠ ç¼“å­˜ã€ä¼˜åŒ–æŸ¥è¯¢é€»è¾‘ï¼Œæˆ–è€…è°ƒæ•´è®¡ç®—é¢‘ç‡ã€‚

### è·å–æ”¯æŒ

- ğŸ“– æŸ¥çœ‹å®Œæ•´æ–‡æ¡£: `docs/03-æŠ€æœ¯æ–‡æ¡£/æŒ‡æ ‡æ ‡å‡†æ¨¡æ¿è§„èŒƒ.md`
- ğŸ” è¿è¡Œä½¿ç”¨ç¤ºä¾‹: `npx tsx src/examples/metric-usage-example.ts`
- ğŸ› æäº¤é—®é¢˜: é€šè¿‡é¡¹ç›®Issueè·Ÿè¸ªå™¨
- ğŸ“§ è”ç³»å›¢é˜Ÿ: æ•°æ®å›¢é˜Ÿ & æŠ€æœ¯å›¢é˜Ÿ

## ğŸ“‹ æ£€æŸ¥æ¸…å•

åœ¨ä½¿ç”¨æŒ‡æ ‡ç³»ç»Ÿä¹‹å‰ï¼Œè¯·ç¡®è®¤ï¼š

- [ ] å·²é˜…è¯»æŒ‡æ ‡æ ‡å‡†æ¨¡æ¿è§„èŒƒæ–‡æ¡£
- [ ] äº†è§£ä¸‰å±‚æŒ‡æ ‡ä½“ç³»çš„åˆ†å·¥å’ŒèŒè´£
- [ ] ç†Ÿæ‚‰å‘½åè§„èŒƒå’Œæ ¼å¼è¦æ±‚
- [ ] çŸ¥é“å¦‚ä½•ä½¿ç”¨éªŒè¯å·¥å…·å’Œæ³¨å†Œè¡¨
- [ ] é…ç½®äº†CI/CDä¸­çš„ä¸€è‡´æ€§æ£€æŸ¥
- [ ] å›¢é˜Ÿæˆå‘˜æ¥å—äº†ç›¸å…³åŸ¹è®­

## ğŸ”® åç»­è§„åˆ’

### å³å°†æ¨å‡ºçš„åŠŸèƒ½
- æŒ‡æ ‡ä¾èµ–å…³ç³»å¯è§†åŒ–
- æ›´å¤šçš„è‡ªåŠ¨ä¿®å¤è§„åˆ™
- æŒ‡æ ‡ä½¿ç”¨æƒ…å†µåˆ†æ
- æ€§èƒ½å½±å“è¯„ä¼°å·¥å…·
- æ›´ä¸°å¯Œçš„å¯¼å‡ºæ ¼å¼

### é•¿æœŸå‘å±•æ–¹å‘
- æ™ºèƒ½æŒ‡æ ‡æ¨è
- å¼‚å¸¸æ£€æµ‹å’Œé¢„è­¦
- å¤šé¡¹ç›®æŒ‡æ ‡åŒæ­¥
- æŒ‡æ ‡è¡€ç¼˜å…³ç³»è¿½è¸ª

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2024-08-25  
**ç»´æŠ¤å›¢é˜Ÿ**: æ•°æ®å›¢é˜Ÿ